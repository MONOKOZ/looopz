<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1DB954">
    <title>LOOOPZ - Create Viral Music Loops from Spotify</title>
    <meta property="og:title" content="LOOOPZ - Create Viral Music Loops">
    <meta property="og:description" content="Create perfect loops from any Spotify track. Precision timing. Endless possibilities.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://looopz.vercel.app/">
    <meta property="og:image" content="https://looopz.vercel.app/og-image.png">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='40' fill='none' stroke='%231DB954' stroke-width='6'/%3E%3Ccircle cx='50' cy='50' r='25' fill='none' stroke='%231DB954' stroke-width='4'/%3E%3Ccircle cx='50' cy='50' r='10' fill='%231DB954'/%3E%3C/svg%3E">
    <link rel="stylesheet" href="style.css" />
   
</head>
<body>
    <div class="app-header">
        <div class="header-content">
            <div class="logo"><a href="/pitch.html" target="_blank" class="logo" style="text-decoration: none; color: inherit;">LOOOPZ</a></div>
            <div class="connection-status" id="connection-status">
                <div class="status-dot"></div>
                <span>Connected</span>
                <button class="disconnect-btn" id="disconnect-btn">Disconnect</button>
            </div>
        </div>
    </div>

    <div class="status-bar" id="status-bar">
        <span id="status-text">Ready</span>
    </div>

    <div class="now-playing-indicator" id="now-playing-indicator">
        <div id="mini-track-title">Now Playing</div>
        <div style="font-size: 10px; opacity: 0.8;" id="mini-track-artist">Artist</div>
    </div>

    <div class="main-container">
        <!-- Login -->
        <div id="login-screen" class="login-screen">
            <div class="login-icon">‚ö°</div>
            <h1 class="login-title">Welcome to LOOOPZ</h1>
            <p class="login-subtitle">Create perfect loops from any Spotify track.<br>Precision timing. Endless possibilities.</p>
            <button class="btn" id="connect-btn">Connect Spotify Premium</button>
            <p style="color: var(--light-gray); font-size: 13px; margin-top: 12px;">Requires Spotify Premium for full track playback</p>
        </div>

        <!-- Search -->
        <div id="search-section" class="hidden">
            <div class="card">
                <div class="search-container">
                    <div class="search-header" id="search-header">
                        <button class="back-btn hidden" id="search-back-btn">‚Üê</button>
                        <input type="text" class="search-input" id="search-input" placeholder="Search for any song..." autocomplete="off">
                    </div>
                </div>
                <div id="search-results">
                    <div style="text-align: center; padding: 40px; color: var(--light-gray);">Search for tracks to start creating loops</div>
                </div>
            </div>
        </div>

        <!-- Player -->
        <div id="player-section" class="hidden">
            <div class="card">
                <div class="now-playing">
                    <div class="current-track" id="current-track">No track selected</div>
                    <div class="current-artist" id="current-artist"></div>
                </div>

                <div class="album-cover-container">
                    <img id="album-cover" class="album-cover" src="" alt="Album Cover" style="display: none;">
                </div>

                <div class="progress-container" id="progress-container">
                    <div class="loop-region" id="loop-region"></div>
                    <div class="progress-bar" id="progress-bar"></div>
                    <div class="loop-handle start" id="loop-start-handle">
                        <div class="time-popup" id="start-popup">0:00.000</div>
                    </div>
                    <div class="loop-handle end" id="loop-end-handle">
                        <div class="time-popup" id="end-popup">0:30.000</div>
                    </div>
                </div>

                <div class="time-display">
                    <span id="current-time">0:00.000</span>
                    <span id="duration">0:00.000</span>
                </div>

                <div class="main-controls">
                    <div class="playback-controls">
                        <button class="control-btn" id="backward-btn">‚è™</button>
                        <button class="control-btn play-pause-btn" id="play-pause-btn">‚ñ∂</button>
                        <button class="control-btn" id="forward-btn">‚è©</button>
                    </div>

                    <div class="loop-controls">
                        <div class="loop-section">
                            <label class="loop-label">Loop Mode</label>
                            <div class="toggle-switch">
                                <input type="checkbox" id="loop-toggle">
                                <span class="toggle-slider"></span>
                            </div>
                        </div>

                        <div class="loop-actions">
                            <button class="btn start-loop-btn" id="start-loop-btn" disabled>Set Loop</button>
                            <button class="btn secondary" id="save-loop-btn">üíæ Save</button>
                            <button class="btn secondary" id="add-to-playlist-btn">+ Playlist</button>
                        </div>

                        <div class="repeat-counter">
                            <button class="repeat-btn" id="repeat-decrease">‚àí</button>
                            <span class="repeat-value" id="repeat-value">1√ó</span>
                            <button class="repeat-btn" id="repeat-increase">+</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fine-tune controls -->
            <div class="fine-tune-section">
                <button class="btn precision-btn" id="precision-btn">‚ö° Precision Editor</button>
                <div class="fine-tune-grid">
                    <button class="fine-tune-btn" data-target="start" data-amount="-0.1">‚àí0.1s</button>
                    <button class="fine-tune-btn" data-target="start" data-amount="-0.01">‚àí0.01s</button>
                    <button class="fine-tune-btn" data-target="start" data-amount="0.01">+0.01s</button>
                    <button class="fine-tune-btn" data-target="start" data-amount="0.1">+0.1s</button>
                    <button class="fine-tune-btn" data-target="end" data-amount="-0.1">‚àí0.1s</button>
                    <button class="fine-tune-btn" data-target="end" data-amount="-0.01">‚àí0.01s</button>
                    <button class="fine-tune-btn" data-target="end" data-amount="0.01">+0.01s</button>
                    <button class="fine-tune-btn" data-target="end" data-amount="0.1">+0.1s</button>
                </div>
            </div>

            <!-- Playlist Now Playing (initially hidden) -->
            <div class="card playlist-now-playing hidden" id="playlist-now-playing">
                <div class="playlist-now-playing-header">
                    <span class="playlist-mode-label">PLAYLIST MODE</span>
                    <span class="playlist-progress" id="playlist-progress">1/0</span>
                </div>
                <div class="playlist-current-item">
                    <img id="playlist-current-icon" class="playlist-current-icon" src="" alt="">
                    <div class="playlist-current-info">
                        <div id="playlist-current-name" class="playlist-current-name">Track Name</div>
                        <div id="playlist-current-type" class="playlist-current-type">Loop: 0:00 - 0:30 (3√ó)</div>
                    </div>
                </div>
                <div class="playlist-playback-controls">
                    <button class="playlist-control-btn" id="playlist-prev-btn">‚èÆ</button>
                    <button class="playlist-control-btn" id="playlist-stop-btn">‚èπ</button>
                    <button class="playlist-control-btn" id="playlist-next-btn">‚è≠</button>
                </div>
            </div>
        </div>

        <!-- Library -->
        <div id="library-section" class="hidden">
            <div class="card">
                <h2 class="section-title">Library</h2>
                <div id="loops-list"></div>
            </div>
        </div>

        <!-- Playlists -->
        <div id="playlists-section" class="hidden">
            <div class="card">
                <div class="section-header">
                    <h2 class="section-title">Playlists</h2>
                    <button class="btn create-playlist-btn" id="create-playlist-btn">+ Create</button>
                </div>
                <div id="playlists-list"></div>
            </div>
        </div>

        <!-- Discovery -->
        <div id="discovery-section" class="hidden">
            <div class="card">
                <h2 class="section-title">Discovery</h2>
                <div style="text-align: center; padding: 60px 20px;">
                    <div style="font-size: 48px; margin-bottom: 16px; opacity: 0.4;">üîÆ</div>
                    <div style="color: var(--light-gray); font-size: 16px; margin-bottom: 8px;">Coming Soon</div>
                    <div style="color: var(--light-gray); font-size: 13px;">AI-powered moment discovery and beat analysis</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Precision Popup -->
    <div class="precision-popup hidden" id="precision-popup">
        <div class="precision-popup-content">
            <div class="precision-header">
                <h3>Precision Loop Editor</h3>
                <button class="close-btn" id="precision-close">√ó</button>
            </div>
            <div class="precision-inputs">
                <div class="precision-field">
                    <label>Start Time</label>
                    <input type="text" id="precision-start" placeholder="0:00.000" autocomplete="off">
                </div>
                <div class="precision-field">
                    <label>End Time</label>
                    <input type="text" id="precision-end" placeholder="0:30.000" autocomplete="off">
                </div>
            </div>
            <div class="precision-tips">
                <p>üí° Tip: Use format M:SS.mmm (e.g., 1:23.456)</p>
            </div>
        </div>
    </div>

    <!-- Track Context Menu -->
    <div class="track-context-menu" id="track-context-menu">
        <button class="context-menu-item" id="discover-moments-btn">
            <span class="context-menu-icon">üîç</span>
            Discover moments
        </button>
        <button class="context-menu-item" id="add-to-playlist-btn-menu">
            <span class="context-menu-icon">‚ûï</span>
            Add to playlist
        </button>
        <button class="context-menu-item" id="play-in-background-btn">
            <span class="context-menu-icon">‚ñ∂Ô∏è</span>
            Play in background
        </button>
    </div>
    <div class="context-menu-overlay" id="context-menu-overlay"></div>

    <!-- Add to Playlist Popup -->
    <div class="add-to-playlist-popup hidden" id="add-to-playlist-popup">
        <div class="add-to-playlist-content">
            <div class="add-to-playlist-header">
                <h3>Add to Playlist</h3>
                <button class="close-btn" id="add-to-playlist-close">√ó</button>
            </div>
            <div class="playlist-selection-list" id="playlist-selection-list"></div>
            <button class="btn secondary" id="quick-create-playlist">+ Create New Playlist</button>
        </div>
    </div>

    <!-- Playlist Form Popup -->
    <div class="playlist-form-popup hidden" id="playlist-form-popup">
        <div class="playlist-form-content">
            <div class="playlist-form-header">
                <h3 id="playlist-form-title">Create Playlist</h3>
                <button class="close-btn" id="playlist-form-close">√ó</button>
            </div>
            <form class="create-playlist-form" id="playlist-form" onsubmit="event.preventDefault(); savePlaylistFromForm();">
                <div class="form-field">
                    <label for="playlist-name-input" class="form-label">Name</label>
                    <input type="text" id="playlist-name-input" class="form-input" placeholder="My Awesome Playlist" required>
                </div>
                <div class="form-field">
                    <label for="playlist-description-input" class="form-label">Description (optional)</label>
                    <textarea id="playlist-description-input" class="form-textarea" placeholder="Add a description..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn secondary" id="playlist-form-cancel">Cancel</button>
                    <button type="submit" class="btn" id="playlist-form-save">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Navigation -->
    <div class="navigation">
        <div class="nav-container">
            <button class="nav-btn active" id="nav-search">
                <div class="nav-icon">üîç</div>
                <div class="nav-label">Search</div>
            </button>
            <button class="nav-btn" id="nav-player">
                <div class="nav-icon">‚ñ∂Ô∏è</div>
                <div class="nav-label">Player</div>
            </button>
            <button class="nav-btn" id="nav-library">
                <div class="nav-icon">üìö</div>
                <div class="nav-label">Library</div>
                <span class="loop-count-badge" id="loop-count-badge">0</span>
            </button>
            <button class="nav-btn" id="nav-playlists">
                <div class="nav-icon">üéµ</div>
                <div class="nav-label">Playlists</div>
                <span class="playlist-count-badge" id="playlist-count-badge">0</span>
            </button>
            <button class="nav-btn" id="nav-discovery">
                <div class="nav-icon">üí¨</div>
                <div class="nav-label">Discovery</div>
            </button>
        </div>
    </div>

    <script src="https://sdk.scdn.co/spotify-player.js"></script>
    <script src="script.js"></script>
</body>
</html>
